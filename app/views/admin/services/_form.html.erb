<%= form_with(model: service, url: service.persisted? ? admin_service_path(service) : admin_services_path , local: true, class: "usa-form") do |form| %>
  <% if service.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(service.errors.count, "error") %> prohibited this service from being saved:</h2>

      <ul class="usa-list">
      <% service.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <div class="field">
    <%= form.label :name, class: "usa-label" %>
    <%= form.text_field :name, class: "usa-input", placeholder: "What is the name of this Service?" %>
  </div>

  <div class="field">
    <%= form.label :description, class: "usa-label" %>
    <%= form.text_area :description, class: "usa-textarea", placeholder: "Describe this Service (audience, reach, metrics)" %>
  </div>

  <% if current_user.admin? %>
    <div class="field">
      <%= form.label :organization, class: "usa-label" %>
      <%= form.select :organization_id, options_for_select(Organization.all.order(:name).map { |org| ["#{org.abbreviation}-#{org.name}", org.id] }, selected: (service.organization ? service.organization.id : nil)), { prompt: "Select an Organization" }, { class: "usa-select" } %>
    </div>
  <% else %>
    <%= form.hidden_field :organization_id, value: current_user.organization.id %>
  <% end %>

  <% if admin_permissions? %>
  <br>
  <fieldset class="usa-fieldset">
    <legend class="usa-sr-only">HISP Agency</legend>
    <div class="usa-checkbox">
      <%= form.check_box :hisp, class: "usa-checkbox__input" %>
      <%= form.label :hisp, "HISP Agency?", class: "usa-checkbox__label" %>
    </div>
  </fieldset>
  <% end %>

  <% if !service.persisted? -%>
  <div class="usa-alert usa-alert--info" >
    <div class="usa-alert__body">
      <p class="usa-alert__text">
        Service Managers and Submissions Viewers
        can be assigned to to this Service after creation.
      </p>
    </div>
  </div>
  <% end %>

  <p>
    <%= form.submit class: "usa-button" %>
  </p>
<% end %>
